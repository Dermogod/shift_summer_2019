# уязвимость/атака

## Описание
Попытайтесь описать почему возникает проблема, чтобы стало понятно как это работает

Механизмы шаблонов широко используются веб-приложениями для представления динамических данных через веб-страницы и электронные письма. Небезопасное встраивание пользовательского ввода в шаблоны позволяет внедрить шаблон на стороне сервера, часто критическую уязвимость, которую очень легко принять за межсайтовый скриптинг (XSS) или полностью ее пропустить. В отличие от XSS, Template Injection можно использовать для прямой атаки на внутренние компоненты веб-серверов и получения удаленного выполнения кода (RCE), превращая каждое уязвимое приложение в потенциальную опорную точку.

Внедрение шаблонов может происходить как из-за ошибки разработчика, так и из-за преднамеренного раскрытия шаблонов в попытке предложить богатую функциональность, как это обычно делают вики, блоги, маркетинговые приложения и системы управления контентом. Преднамеренное внедрение шаблона является настолько распространенным случаем использования, что многие движки шаблонов предлагают режим «песочницы» для этой экспресс-цели. В этом документе определяется методология обнаружения и использования внедрения шаблона и показано, что он применяется для создания нулевых дней RCE для двух широко развернутых корпоративных веб-приложений. Общие эксплойты продемонстрированы для пяти самых популярных шаблонизаторов, в том числе для выхода из песочниц, цель которых - безопасная обработка пользовательских шаблонов.

Mekhanizmy shablonov shiroko ispol'zuyutsya veb-prilozheniyami dlya predstavleniya dinamicheskikh dannykh cherez veb-stranitsy i elektronnyye pis'ma. Nebezopasnoye vstraivaniye pol'zovatel'skogo vvoda v shablony pozvolyayet vnedrit' shablon na storone servera, chasto kriticheskuyu uyazvimost', kotoruyu ochen' legko prinyat' za mezhsaytovyy skripting (XSS) ili polnost'yu yeye propustit'. V otlichiye ot XSS, Template Injection mozhno ispol'zovat' dlya pryamoy ataki na vnutrenniye komponenty veb-serverov i polucheniya udalennogo vypolneniya koda (RCE), prevrashchaya kazhdoye uyazvimoye prilozheniye v potentsial'nuyu opornuyu tochku.

Vnedreniye shablonov mozhet proiskhodit' kak iz-za oshibki razrabotchika, tak i iz-za prednamerennogo raskrytiya shablonov v popytke predlozhit' bogatuyu funktsional'nost', kak eto obychno delayut viki, blogi, marketingovyye prilozheniya i sistemy upravleniya kontentom. Prednamerennoye vnedreniye shablona yavlyayetsya nastol'ko rasprostranennym sluchayem ispol'zovaniya, chto mnogiye dvizhki shablonov predlagayut rezhim «pesochnitsy» dlya etoy ekspress-tseli. V etom dokumente opredelyayetsya metodologiya obnaruzheniya i ispol'zovaniya vnedreniya shablona i pokazano, chto on primenyayetsya dlya sozdaniya nulevykh dney RCE dlya dvukh shiroko razvernutykh korporativnykh veb-prilozheniy. Obshchiye eksployty prodemonstrirovany dlya pyati samykh populyarnykh shablonizatorov, v tom chisle dlya vykhoda iz pesochnits, tsel' kotorykh - bezopasnaya obrabotka pol'zovatel'skikh shablonov.

Уязвимость часто возникает из-за того, что разработчики дают возможность пользователю изменять шаблон (некоторые шаблонизаторы предлагают безопасный режим для этих целей).
Все функции, которые используют данные введенные пользователем, могут быть уязвимы, в том числе вики-страницы, ревью и комментарии. Также, причиной уязвимости может быть то, что пользовательские данные вставляются непосредственно в шаблон.

https://defcon.ru/web-security/3840/
## Классификация
Если существует какая-то классификация уязвимости/атаки - напишите о ней. Например, могут быть разные техники эксплуатации

## Условия
- ОС: если проблема специфична для определенной ОС
- язык: если проблема специфичная для определенных языков - специфична для flask, jinja2
- компоненты: какие компоненты подвержены проблеме. Это могут быть библиотеки, базы данных, фреймворки, брокеры очередей и т.д.
- настройки: может есть какие-то специфичные настройки

Можно добавить еще информацию, которая не подходит под пункты выше, самостоятельно

## Детектирование
Описать как проблема детектируется. На что обращают внимание. Можно ли проблему детектировать автоматизированно или только вручную.
Если автоматизированно, то как лучше детектировать - код ревью или сканирование уязвимостей?

Информация:
- в каждый пункт можно добавлять необходимую информацию из статей в ввиде ссылок - [google.com](https://www.google.com)

## Эксплуатация
Здесь необходимо описать пример ручной эксплуатации. Сразу уточните какой это язык, какие компоненты используются, если эксплуатация специфична только для этих условий. Можно записать сюда порядок действий при эксплуатации тестового задания

### Инструменты
- здесь можно перечислить ссылками инструменты и полезную информацию, которая может понадобиться для эксплуатации

https://github.com/epinna/tplmap

## Ущерб
Описать во что возможно развитие вектора атаки, если не существует защитных мер вовсе. То есть описать, что максимльно может получить злоумышленник, если все условия сойдутся.

Написать, к чему могут привести в итоге эксплуатация этих векторов атак

## Защита
### Основные меры
В основных мерах описываем способы как 100% защититься от уязвимости/атаки

### Превентивные меры
А здесь описываем как можем уменьшить ущерб от уязвимости/атаки, если она существует. То есть, подход Defense in Depth.

## Дополнительно
Здесь приложить дополнительную информацию и источники, которые использовали, но не указали выше в других местах.

## Обход защиты
Если существуют варианты обхода защиты, то можно их здесь перечислить.

Если есть возможность, то надо написать в чем заключается защита и каким образом она обходится.
